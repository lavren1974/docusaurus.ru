"use strict";(self.webpackChunkdocusaurus_ru=self.webpackChunkdocusaurus_ru||[]).push([[1594],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=r.createContext({}),p=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=p(n),h=a,m=d["".concat(l,".").concat(h)]||d[h]||u[h]||i;return n?r.createElement(m,o(o({ref:t},c),{},{components:n})):r.createElement(m,o({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},60968:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>p});var r=n(87462),a=(n(67294),n(3905));const i={sidebar_position:2},o="Extending infrastructure",s={unversionedId:"api/plugin-methods/extend-infrastructure",id:"api/plugin-methods/extend-infrastructure",title:"Extending infrastructure",description:"Docusaurus has some infrastructure like hot reloading, CLI, and swizzling, that can be extended by external plugins.",source:"@site/docs/api/plugin-methods/extend-infrastructure.md",sourceDirName:"api/plugin-methods",slug:"/api/plugin-methods/extend-infrastructure",permalink:"/docs/api/plugin-methods/extend-infrastructure",draft:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"api",previous:{title:"Lifecycle APIs",permalink:"/docs/api/plugin-methods/lifecycle-apis"},next:{title:"I18n lifecycles",permalink:"/docs/api/plugin-methods/i18n-lifecycles"}},l={},p=[{value:"<code>getPathsToWatch()</code>",id:"getPathsToWatch",level:2},{value:"<code>extendCli(cli)</code>",id:"extendCli",level:2},{value:"<code>getThemePath()</code>",id:"getThemePath",level:2},{value:"<code>getTypeScriptThemePath()</code>",id:"getTypeScriptThemePath",level:2},{value:"<code>getSwizzleComponentList()</code>",id:"getSwizzleComponentList",level:2}],c={toc:p};function u(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"extending-infrastructure"},"Extending infrastructure"),(0,a.kt)("p",null,"Docusaurus has some infrastructure like hot reloading, CLI, and swizzling, that can be extended by external plugins."),(0,a.kt)("h2",{id:"getPathsToWatch"},(0,a.kt)("inlineCode",{parentName:"h2"},"getPathsToWatch()")),(0,a.kt)("p",null,"Specifies the paths to watch for plugins and themes. The paths are watched by the dev server so that the plugin lifecycles are reloaded when contents in the watched paths change. Note that the plugins and themes modules are initially called with ",(0,a.kt)("inlineCode",{parentName:"p"},"context")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"options")," from Node, which you may use to find the necessary directory information about the site."),(0,a.kt)("p",null,"Use this for files that are consumed server-side, because theme files are automatically watched by Webpack dev server."),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="docusaurus-plugin/src/index.js"',title:'"docusaurus-plugin/src/index.js"'},"const path = require('path');\nmodule.exports = function (context, options) {\n  return {\n    name: 'docusaurus-plugin',\n    // highlight-start\n    getPathsToWatch() {\n      const contentPath = path.resolve(context.siteDir, options.path);\n      return [`${contentPath}/**/*.{ts,tsx}`];\n    },\n    // highlight-end\n  };\n};\n")),(0,a.kt)("h2",{id:"extendCli"},(0,a.kt)("inlineCode",{parentName:"h2"},"extendCli(cli)")),(0,a.kt)("p",null,"Register an extra command to enhance the CLI of Docusaurus. ",(0,a.kt)("inlineCode",{parentName:"p"},"cli")," is a ",(0,a.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/commander/v/5.1.0"},"commander")," object."),(0,a.kt)("admonition",{type:"caution"},(0,a.kt)("p",{parentName:"admonition"},"The commander version matters! We use commander v5, and make sure you are referring to the right version documentation for available APIs.")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="docusaurus-plugin/src/index.js"',title:'"docusaurus-plugin/src/index.js"'},"module.exports = function (context, options) {\n  return {\n    name: 'docusaurus-plugin',\n    // highlight-start\n    extendCli(cli) {\n      cli\n        .command('roll')\n        .description('Roll a random number between 1 and 1000')\n        .action(() => {\n          console.log(Math.floor(Math.random() * 1000 + 1));\n        });\n    },\n    // highlight-end\n  };\n};\n")),(0,a.kt)("h2",{id:"getThemePath"},(0,a.kt)("inlineCode",{parentName:"h2"},"getThemePath()")),(0,a.kt)("p",null,"Returns the path to the directory where the theme components can be found. When your users call ",(0,a.kt)("inlineCode",{parentName:"p"},"swizzle"),", ",(0,a.kt)("inlineCode",{parentName:"p"},"getThemePath")," is called and its returned path is used to find your theme components. Relative paths are resolved against the folder containing the entry point."),(0,a.kt)("p",null,"For example, your ",(0,a.kt)("inlineCode",{parentName:"p"},"getThemePath")," can be:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="my-theme/src/index.js"',title:'"my-theme/src/index.js"'},"const path = require('path');\n\nmodule.exports = function (context, options) {\n  return {\n    name: 'my-theme',\n    // highlight-start\n    getThemePath() {\n      return './theme';\n    },\n    // highlight-end\n  };\n};\n")),(0,a.kt)("h2",{id:"getTypeScriptThemePath"},(0,a.kt)("inlineCode",{parentName:"h2"},"getTypeScriptThemePath()")),(0,a.kt)("p",null,"Similar to ",(0,a.kt)("inlineCode",{parentName:"p"},"getThemePath()"),", it should return the path to the directory where the source code of TypeScript theme components can be found. This path is purely for swizzling TypeScript theme components, and theme components under this path will ",(0,a.kt)("strong",{parentName:"p"},"not")," be resolved by Webpack. Therefore, it is not a replacement for ",(0,a.kt)("inlineCode",{parentName:"p"},"getThemePath()"),". Typically, you can make the path returned by ",(0,a.kt)("inlineCode",{parentName:"p"},"getTypeScriptThemePath()")," be your source directory, and make the path returned by ",(0,a.kt)("inlineCode",{parentName:"p"},"getThemePath()")," be the compiled JavaScript output."),(0,a.kt)("admonition",{type:"tip"},(0,a.kt)("p",{parentName:"admonition"},"For TypeScript theme authors: you are strongly advised to make your compiled output as human-readable as possible. Only strip type annotations and don't transpile any syntaxes, because they will be handled by Webpack's Babel loader based on the targeted browser versions."),(0,a.kt)("p",{parentName:"admonition"},"You should also format these files with Prettier. Remember\u2014JS files can and will be directly consumed by your users.")),(0,a.kt)("p",null,"Example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="my-theme/src/index.js"',title:'"my-theme/src/index.js"'},"const path = require('path');\n\nmodule.exports = function (context, options) {\n  return {\n    name: 'my-theme',\n    // highlight-start\n    getThemePath() {\n      // Where compiled JavaScript output lives\n      return '../lib/theme';\n    },\n    getTypeScriptThemePath() {\n      // Where TypeScript source code lives\n      return '../src/theme';\n    },\n    // highlight-end\n  };\n};\n")),(0,a.kt)("h2",{id:"getSwizzleComponentList"},(0,a.kt)("inlineCode",{parentName:"h2"},"getSwizzleComponentList()")),(0,a.kt)("p",null,(0,a.kt)("strong",{parentName:"p"},"This is a static method, not attached to any plugin instance.")),(0,a.kt)("p",null,"Returns a list of stable components that are considered safe for swizzling. These components will be swizzlable without ",(0,a.kt)("inlineCode",{parentName:"p"},"--danger"),". All components are considered unstable by default. If an empty array is returned, all components are considered unstable. If ",(0,a.kt)("inlineCode",{parentName:"p"},"undefined")," is returned, all components are considered stable."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="my-theme/src/index.js"',title:'"my-theme/src/index.js"'},"const swizzleAllowedComponents = [\n  'CodeBlock',\n  'DocSidebar',\n  'Footer',\n  'NotFound',\n  'SearchBar',\n  'hooks/useTheme',\n  'prism-include-languages',\n];\n\nmyTheme.getSwizzleComponentList = () => swizzleAllowedComponents;\n")))}u.isMDXComponent=!0}}]);